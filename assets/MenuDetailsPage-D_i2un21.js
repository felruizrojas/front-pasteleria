import{c as q,_ as G,a as J,b as Z,d as W,e as aa,f as ea,g as sa,h as ta,i as oa,j as _a,k as na,l as ca,m as ra,n as ia,o as la,p as da,q as ga}from"./menu_datos-Ao8HE8cF.js";import{j as a,L as R,d as ma,r as i}from"./index-CtA74-58.js";import{B as D,c as P}from"./Input-CJ-O810F.js";const pa=({items:t,className:o})=>{const c=t.length-1;return a.jsx("nav",{"aria-label":"breadcrumb",className:o,children:a.jsx("ol",{className:"breadcrumb small mb-0",children:t.map((e,m)=>m===c||!e.to?a.jsx("li",{className:"breadcrumb-item active","aria-current":"page",children:e.label},e.label):a.jsx("li",{className:"breadcrumb-item",children:a.jsx(R,{to:e.to,children:e.label})},e.label))})})},ua="/front-pasteleria/assets/brownie_sin_gluten_1-DqOxKQHv.png",ba="/front-pasteleria/assets/brownie_sin_gluten_2-DKs09f1f.png",fa="/front-pasteleria/assets/brownie_sin_gluten_3-CmrM3ioq.png",ha="/front-pasteleria/assets/cheesecake_sin_azucar_1-CD9IPjcH.png",va="/front-pasteleria/assets/cheesecake_sin_azucar_2-Comqk52f.png",xa="/front-pasteleria/assets/cheesecake_sin_azucar_3-CtBxU-CQ.png",ja="/front-pasteleria/assets/empanada_de_manzana_1-BJBEO1_X.png",Na="/front-pasteleria/assets/empanada_de_manzana_2-B_dPzrkd.png",Ca="/front-pasteleria/assets/empanada_de_manzana_3-DivyXRTy.png",wa="/front-pasteleria/assets/galletas_veganas_de_avena_1-B_QLCY3K.png",ya="/front-pasteleria/assets/galletas_veganas_de_avena_2-CwTtlP-f.png",za="/front-pasteleria/assets/galletas_veganas_de_avena_3-BeFXEJ_T.png",ka="/front-pasteleria/assets/mousse_de_chocolate_1-6KZk2G3R.png",Ma="/front-pasteleria/assets/mousse_de_chocolate_2-De1FT4V9.png",Ia="/front-pasteleria/assets/mousse_de_chocolate_3-DbXrsipu.png",Ba="/front-pasteleria/assets/pan_sin_gluten_1-BC60DwBT.png",La="/front-pasteleria/assets/pan_sin_gluten_2-DrqYAyBi.png",Da="/front-pasteleria/assets/pan_sin_gluten_3-BPQm470H.png",Ea="/front-pasteleria/assets/tarta_de_santiago_1-CzsxXRgz.png",Sa="/front-pasteleria/assets/tarta_de_santiago_2-CwQk8IO6.png",Fa="/front-pasteleria/assets/tarta_de_santiago_3-DjnzZYcj.png",$a="/front-pasteleria/assets/tiramisu_clasico_1-CHNBc5YI.png",Qa="/front-pasteleria/assets/tiramisu_clasico_2-jB-xurmi.png",Ta="/front-pasteleria/assets/tiramisu_clasico_3-CynLgp3o.png",Pa="/front-pasteleria/assets/torta_circular_de_manjar_1-CEeqBkRf.png",Aa="/front-pasteleria/assets/torta_circular_de_manjar_2-BoSGH5_2.png",Oa="/front-pasteleria/assets/torta_circular_de_manjar_3-BHe0rtV4.png",qa="/front-pasteleria/assets/torta_circular_de_vainilla_1-DG5FCMy_.png",Ra="/front-pasteleria/assets/torta_circular_de_vainilla_2-Ya90OT00.png",Ua="/front-pasteleria/assets/torta_circular_de_vainilla_3-BkCy9Itu.png",Ka="/front-pasteleria/assets/torta_cuadrada_de_chocolate_1-BnTipuS3.png",Xa="/front-pasteleria/assets/torta_cuadrada_de_chocolate_2-CnsF9V93.png",Ya="/front-pasteleria/assets/torta_cuadrada_de_chocolate_3-DUlAeO-F.png",Ha="/front-pasteleria/assets/torta_cuadrada_de_frutas_1-Br_wNIqW.png",Va="/front-pasteleria/assets/torta_cuadrada_de_frutas_2-CmbhhoKI.png",Ga="/front-pasteleria/assets/torta_cuadrada_de_frutas_3-BnwhZism.png",Ja="/front-pasteleria/assets/torta_especial_de_boda_1-DF5QaUZK.png",Za="/front-pasteleria/assets/torta_especial_de_boda_2-8dL3UFpw.png",Wa="/front-pasteleria/assets/torta_especial_de_boda_3-CDnAkATL.png",ae="/front-pasteleria/assets/torta_especial_de_cumpleanos_1-CsP7vUhi.png",ee="/front-pasteleria/assets/torta_especial_de_cumpleanos_2-cdmMp_QU.png",se="/front-pasteleria/assets/torta_especial_de_cumpleanos_3-na3XDunC.png",te="/front-pasteleria/assets/torta_sin_azucar_de_naranja_1_600x400-BKkChXTQ.png",oe="/front-pasteleria/assets/torta_sin_azucar_de_naranja_2_600x400-BRTClym_.png",_e="/front-pasteleria/assets/torta_sin_azucar_de_naranja_3_600x400-DDxpa65P.png",ne="/front-pasteleria/assets/torta_vegana_de_chocolate_1_600x400-DzEEE3fA.png",ce="/front-pasteleria/assets/torta_vegana_de_chocolate_2_600x400-spO4yCme.png",re="/front-pasteleria/assets/torta_vegana_de_chocolate_3_600x400-DuMuAw9c.png",j="carrito",E="mensajesCarrito",S=25,ie=Object.assign({"/src/assets/images/catalog/brownie_sin_gluten.jpg":ga,"/src/assets/images/catalog/cheesecake_sin_azucar.jpg":da,"/src/assets/images/catalog/empanada_de_manzana.jpg":la,"/src/assets/images/catalog/galletas_veganas_de_avena.jpg":ia,"/src/assets/images/catalog/mousse_de_chocolate.jpg":ra,"/src/assets/images/catalog/pan_sin_gluten.jpg":ca,"/src/assets/images/catalog/tarta_de_santiago.jpg":na,"/src/assets/images/catalog/tiramisu_clasico.jpg":_a,"/src/assets/images/catalog/torta_circular_de_manjar.jpg":oa,"/src/assets/images/catalog/torta_circular_de_vainilla.jpg":ta,"/src/assets/images/catalog/torta_cuadrada_de_chocolate.jpg":sa,"/src/assets/images/catalog/torta_cuadrada_de_frutas.jpg":ea,"/src/assets/images/catalog/torta_especial_de_boda.jpg":aa,"/src/assets/images/catalog/torta_especial_de_cumpleanos.jpg":W,"/src/assets/images/catalog/torta_sin_azucar_de_naranja.jpg":Z,"/src/assets/images/catalog/torta_vegana_de_chocolate.jpg":J}),A=Object.entries(ie).reduce((t,[o,c])=>{const e=o.split("/").pop();return e&&(t[e]=c),t},{}),y=t=>{const o=t.split("/").pop();if(o&&A[o])return A[o];const c=t.replace(/^img\//,"images/").replace("catalogo","catalog");return new URL(Object.assign({"/src/assets/index.ts":G})[`@/assets/${c}`],import.meta.url).href},le=Object.assign({"/src/assets/images/catalog_detail/brownie_sin_gluten_1.png":ua,"/src/assets/images/catalog_detail/brownie_sin_gluten_2.png":ba,"/src/assets/images/catalog_detail/brownie_sin_gluten_3.png":fa,"/src/assets/images/catalog_detail/cheesecake_sin_azucar_1.png":ha,"/src/assets/images/catalog_detail/cheesecake_sin_azucar_2.png":va,"/src/assets/images/catalog_detail/cheesecake_sin_azucar_3.png":xa,"/src/assets/images/catalog_detail/empanada_de_manzana_1.png":ja,"/src/assets/images/catalog_detail/empanada_de_manzana_2.png":Na,"/src/assets/images/catalog_detail/empanada_de_manzana_3.png":Ca,"/src/assets/images/catalog_detail/galletas_veganas_de_avena_1.png":wa,"/src/assets/images/catalog_detail/galletas_veganas_de_avena_2.png":ya,"/src/assets/images/catalog_detail/galletas_veganas_de_avena_3.png":za,"/src/assets/images/catalog_detail/mousse_de_chocolate_1.png":ka,"/src/assets/images/catalog_detail/mousse_de_chocolate_2.png":Ma,"/src/assets/images/catalog_detail/mousse_de_chocolate_3.png":Ia,"/src/assets/images/catalog_detail/pan_sin_gluten_1.png":Ba,"/src/assets/images/catalog_detail/pan_sin_gluten_2.png":La,"/src/assets/images/catalog_detail/pan_sin_gluten_3.png":Da,"/src/assets/images/catalog_detail/tarta_de_santiago_1.png":Ea,"/src/assets/images/catalog_detail/tarta_de_santiago_2.png":Sa,"/src/assets/images/catalog_detail/tarta_de_santiago_3.png":Fa,"/src/assets/images/catalog_detail/tiramisu_clasico_1.png":$a,"/src/assets/images/catalog_detail/tiramisu_clasico_2.png":Qa,"/src/assets/images/catalog_detail/tiramisu_clasico_3.png":Ta,"/src/assets/images/catalog_detail/torta_circular_de_manjar_1.png":Pa,"/src/assets/images/catalog_detail/torta_circular_de_manjar_2.png":Aa,"/src/assets/images/catalog_detail/torta_circular_de_manjar_3.png":Oa,"/src/assets/images/catalog_detail/torta_circular_de_vainilla_1.png":qa,"/src/assets/images/catalog_detail/torta_circular_de_vainilla_2.png":Ra,"/src/assets/images/catalog_detail/torta_circular_de_vainilla_3.png":Ua,"/src/assets/images/catalog_detail/torta_cuadrada_de_chocolate_1.png":Ka,"/src/assets/images/catalog_detail/torta_cuadrada_de_chocolate_2.png":Xa,"/src/assets/images/catalog_detail/torta_cuadrada_de_chocolate_3.png":Ya,"/src/assets/images/catalog_detail/torta_cuadrada_de_frutas_1.png":Ha,"/src/assets/images/catalog_detail/torta_cuadrada_de_frutas_2.png":Va,"/src/assets/images/catalog_detail/torta_cuadrada_de_frutas_3.png":Ga,"/src/assets/images/catalog_detail/torta_especial_de_boda_1.png":Ja,"/src/assets/images/catalog_detail/torta_especial_de_boda_2.png":Za,"/src/assets/images/catalog_detail/torta_especial_de_boda_3.png":Wa,"/src/assets/images/catalog_detail/torta_especial_de_cumpleanos_1.png":ae,"/src/assets/images/catalog_detail/torta_especial_de_cumpleanos_2.png":ee,"/src/assets/images/catalog_detail/torta_especial_de_cumpleanos_3.png":se,"/src/assets/images/catalog_detail/torta_sin_azucar_de_naranja_1_600x400.png":te,"/src/assets/images/catalog_detail/torta_sin_azucar_de_naranja_2_600x400.png":oe,"/src/assets/images/catalog_detail/torta_sin_azucar_de_naranja_3_600x400.png":_e,"/src/assets/images/catalog_detail/torta_vegana_de_chocolate_1_600x400.png":ne,"/src/assets/images/catalog_detail/torta_vegana_de_chocolate_2_600x400.png":ce,"/src/assets/images/catalog_detail/torta_vegana_de_chocolate_3_600x400.png":re}),de=Object.entries(le).reduce((t,[o,c])=>{const e=o.split("/").pop();if(!e)return t;const l=e.replace(/\.[^/.]+$/,"").replace(/_\d.*$/,"");return t[l]||(t[l]=[]),t[l].push(c),t},{}),ge=t=>t.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,""),O=t=>t.toLocaleString("es-CL",{style:"currency",currency:"CLP",maximumFractionDigits:0}),U=typeof window<"u",x=(t,o)=>{if(!U)return o;try{const c=window.localStorage.getItem(t);return c?JSON.parse(c):o}catch{return o}},F=(t,o)=>{if(U)try{window.localStorage.setItem(t,JSON.stringify(o))}catch{}},me=(t,o,c)=>{const e=x(j,[]),m=t.codigo_producto.toLowerCase(),l=(c??"").trim(),N=t.stock??1/0,d=e.filter(r=>typeof r=="object"&&r.codigo?.toLowerCase()===m).reduce((r,u)=>r+Number(u.cantidad??0),0),b=e.findIndex(r=>r.codigo?.toLowerCase()===m&&(r.mensaje??"").trim()===l);if(b>=0){const r={...e[b]},u=Number(r.cantidad??0),p=Math.max(0,N-(d-u)),f=Math.min(o,p);r.cantidad=u+f,l?r.mensaje=l:delete r.mensaje,e[b]=r}else{const r=Math.max(0,N-d),u=Math.min(o,r);if(u<=0){F(j,e);return}const p={codigo:t.codigo_producto,nombre:t.nombre_producto,precio:t.precio_producto,imagen:t.imagen_producto,cantidad:u};l&&(p.mensaje=l),e.push(p)}F(j,e)},pe=()=>q.categorias.flatMap(t=>t.productos),ue=(t,o)=>i.useMemo(()=>{const c=t.filter(m=>m.codigo_producto!==o?.codigo_producto);if(!c.length)return[];const e=[...c].sort(()=>Math.random()-.5);return e.slice(0,Math.min(3,e.length))},[t,o]),xe=()=>{const{productCode:t}=ma(),o=t?.toUpperCase()??"",c=i.useMemo(pe,[]),e=i.useMemo(()=>c.find(s=>s.codigo_producto.toUpperCase()===o),[c,o]),m=i.useMemo(()=>q.categorias.find(s=>s.productos.some(_=>_.codigo_producto===e?.codigo_producto)),[e]),l=ue(c,e),N=i.useMemo(()=>{const s=[{label:"Inicio",to:"/"},{label:"Nuestra carta",to:"/menu"}];return e&&(m&&s.push({label:m.nombre_categoria,to:`/menu?categoria=${m.id_categoria}`}),s.push({label:e.nombre_producto})),s},[m,e]),d=e?.stock??1,b=i.useCallback(s=>Number.isNaN(s)||s<=0?0:Math.min(Math.floor(s),d),[d]),r=s=>{const _=s.target.value;if(_===""){g("");return}const n=Number(_);if(!Number.isNaN(n)){if(n>d&&d>0){g(d),v({text:`Sin stock suficiente. Máximo ${d} ${d===1?"unidad disponible":"unidades disponibles"}.`,tone:"danger"});return}g(n)}},u=()=>{const s=Number(k);if(Number.isNaN(s)||s<1){g("");return}g(b(s))},p=i.useMemo(()=>{if(!e)return[];const s=ge(e.nombre_producto),_=[...de[s]??[]].sort(),n=y(e.imagen_producto),I=new Set([n,..._]);return Array.from(I)},[e]),[f,z]=i.useState(""),[k,g]=i.useState(""),[C,$]=i.useState(null),[Q,w]=i.useState(null),h=i.useRef(null),v=i.useCallback(s=>{$(s),h.current&&window.clearTimeout(h.current),h.current=window.setTimeout(()=>$(null),3500)},[]);i.useEffect(()=>{if(!e)return;const _=x(j,[]).find(n=>n.codigo?.toLowerCase()===e.codigo_producto.toLowerCase());if(_?.cantidad){g(b(_.cantidad));return}g("")},[e,b]),i.useEffect(()=>{if(!e)return;const s=x(E,{});z(s[e.codigo_producto]??"")},[e]),i.useEffect(()=>{if(!e){w(null);return}if(!p.length){w(y(e.imagen_producto));return}w(s=>s&&p.includes(s)?s:p[0])},[p,e]);const M=(s,_)=>{const n=x(E,{});_?n[s]=_:delete n[s],F(E,n)},K=s=>{if(!e)return;const _=s.target.value.slice(0,S);z(_),M(e.codigo_producto,_)},X=()=>{if(!e)return;const s=e.stock??0,_=Number(k),n=b(Number.isNaN(_)?0:_);if(s<=0||n<=0){v({text:"Sin stock disponible para este producto en este momento.",tone:"danger"}),g("");return}if(n<_){g(n),v({text:`Sin stock suficiente. Máximo ${s} ${s===1?"unidad disponible":"unidades disponibles"}.`,tone:"danger"}),g("");return}n!==_&&g(n);const I=x(j,[]),Y=e.codigo_producto.toLowerCase(),T=I.filter(L=>L.codigo?.toLowerCase()===Y).reduce((L,V)=>L+Number(V.cantidad??0),0);if(T+n>s){v({text:`Sin stock suficiente. Ya tienes ${T} en el carrito. Máximo ${s} ${s===1?"unidad disponible":"unidades disponibles"}.`,tone:"danger"}),g("");return}const B=f.trim();M(e.codigo_producto,B),me(e,n,B);const H=n===1?"1 unidad":`${n} unidades`;v({text:`Cantidad seleccionada: ${H}. ${B?"Mensaje personalizado guardado. Puedes revisarlo en tu carrito.":"Mensaje eliminado para este producto."}`,tone:"success"}),z(""),M(e.codigo_producto,""),g("")};return i.useEffect(()=>()=>{h.current&&window.clearTimeout(h.current)},[]),e?a.jsxs("section",{className:"container py-4 py-lg-5",children:[a.jsx(pa,{items:N,className:"mb-4"}),a.jsxs("div",{className:"row g-4",children:[a.jsx("div",{className:"col-lg-7",children:a.jsx("div",{className:"card card-soft shadow-soft h-100 d-flex",children:a.jsxs("div",{className:"card-body p-3 d-flex flex-column flex-lg-row gap-3 h-100",children:[a.jsx("div",{className:"flex-grow-1 d-flex align-items-center justify-content-center",children:a.jsx("div",{className:"ratio ratio-4x3 w-100",children:a.jsx("img",{src:Q??y(e.imagen_producto),alt:e.nombre_producto,className:"w-100 h-100 object-fit-cover rounded"})})}),p.length>1?a.jsx("div",{className:"menu-gallery__thumbs menu-gallery__thumbs--vertical",role:"list",children:p.map(s=>{const _=s===Q;return a.jsx("button",{type:"button",className:P("menu-gallery__thumb",{active:_}),onClick:()=>w(s),"aria-pressed":_,role:"listitem","aria-label":_?"Imagen seleccionada":"Ver esta imagen",children:a.jsx("img",{src:s,alt:`${e.nombre_producto} vista adicional`,className:"object-fit-cover",loading:"lazy"})},s)})}):null]})})}),a.jsx("div",{className:"col-lg-5",children:a.jsx("div",{className:"card card-soft card-soft--compact shadow-soft h-100",children:a.jsxs("div",{className:"card-body d-flex flex-column gap-1",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"h3 mb-1",children:e.nombre_producto}),a.jsxs("div",{className:"small mb-1",children:[a.jsx("span",{className:"me-2",children:"Código:"}),a.jsx("code",{children:e.codigo_producto})]}),a.jsx("p",{className:"h4 mb-2",children:O(e.precio_producto)})]}),a.jsx("p",{className:"mb-2",children:e.descripción_producto}),a.jsx("hr",{className:"my-2"}),a.jsxs("div",{children:[a.jsx("label",{className:"form-label",htmlFor:"customMessage",children:"Mensaje personalizado (opcional)"}),a.jsx("textarea",{id:"customMessage",className:"form-control",rows:2,maxLength:S,placeholder:"¡Feliz cumpleaños, Marta!",value:f,onChange:K}),a.jsxs("div",{className:"form-text text-end mt-0",children:[f.length,"/",S," caracteres"]})]}),a.jsxs("div",{className:"mt-1",children:[a.jsxs("div",{className:"row g-3 align-items-end",children:[a.jsxs("div",{className:"col-12 col-sm-6",children:[a.jsx("label",{className:"form-label",htmlFor:"productQuantity",children:"Cantidad"}),a.jsx("input",{type:"number",id:"productQuantity",className:"form-control",min:1,max:d,value:k,onChange:r,onBlur:u})]}),a.jsx("div",{className:"col-12 col-sm-6 d-grid",children:a.jsx(D,{type:"button",size:"lg",variant:"mint",onClick:X,block:!0,children:"Añadir al carrito"})})]}),a.jsxs("div",{className:"form-text text-end text-sm-start mt-1",children:["Máximo ",d," ",d===1?"unidad disponible":"unidades disponibles"]})]}),C?a.jsx("div",{className:P("small mt-1",{"text-success":C.tone==="success","text-danger":C.tone==="danger"}),role:"status","aria-live":"polite",children:C.text}):null,a.jsx("hr",{className:"my-2"}),a.jsxs("ul",{className:"list-unstyled small mb-0",children:[a.jsxs("li",{children:[a.jsx("i",{className:"bi bi-check2-circle me-2","aria-hidden":"true"}),"Decoración personalizable"]}),a.jsxs("li",{children:[a.jsx("i",{className:"bi bi-truck me-2","aria-hidden":"true"}),"Envíos en Concepción y alrededores"]})]})]})})})]}),a.jsxs("section",{className:"mt-5",children:[a.jsx("h2",{className:"h5 mb-3",children:"Productos recomendados"}),l.length===0?a.jsx("p",{className:"mb-0",children:"Pronto añadiremos más recomendaciones."}):a.jsx("div",{className:"row row-cols-1 row-cols-md-3 g-3",children:l.map(s=>a.jsx("div",{className:"col",children:a.jsxs("div",{className:"card card-soft h-100 shadow-soft product-card",children:[a.jsx(R,{to:`/menu/${s.codigo_producto}`,className:"ratio ratio-4x3",children:a.jsx("img",{src:y(s.imagen_producto),alt:s.nombre_producto,className:"rounded-top w-100 h-100 object-fit-cover",loading:"lazy"})}),a.jsxs("div",{className:"card-body d-flex flex-column gap-2",children:[a.jsx("h3",{className:"h6 mb-0",children:s.nombre_producto}),a.jsx("p",{className:"mb-0",children:O(s.precio_producto)}),a.jsx(D,{as:"link",to:`/menu/${s.codigo_producto}`,size:"sm",variant:"strawberry",children:"Ver detalle"})]})]})},s.codigo_producto))})]})]}):a.jsx("section",{className:"container py-5",children:a.jsxs("div",{className:"card card-soft shadow-soft p-5 text-center",children:[a.jsx("h1",{className:"section-title mb-3",children:"Producto no encontrado"}),a.jsx("p",{className:"mb-4",children:"Es posible que el código ingresado no exista o que el producto haya sido actualizado."}),a.jsx(D,{as:"link",to:"/menu",variant:"mint",children:"Volver a la carta"})]})})};export{xe as default};
